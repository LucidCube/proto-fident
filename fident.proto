syntax = "proto3";

package fident;

message ServiceRegistrationResult {
  string identityID = 1;
  string serviceKey = 2;
  string keyHandle = 3;
}

message ServiceRegistrationPayload {
  string serviceName = 1;
  string serviceVendor = 2;
  string supportEmail = 3;
}

message AuthResult {
  string token = 1;
}

message AuthChallengeResult {
  string challenge = 1;
}

message AuthChallengePayload {
  string username = 1;
}

message PerformAuthPayload {
  string username = 1;
  string keyHandle = 2;
  string challengeResponse = 3;
}

message AuthKeyRequestPayload {
  string username = 1;
  string password = 2;
}

message AuthKeyResult {
  string username = 1;
  string identityID = 2;
  string privateKey = 3;
  string keyHandle = 4;
}

service Auth {
  rpc createServiceAccount(ServiceRegistrationPayload) returns (ServiceRegistrationResult) {};
  rpc getAuthenticationChallenge(AuthChallengePayload) returns (AuthChallengeResult) {};
  rpc getNewAuthenticationKey(AuthKeyRequestPayload) returns (AuthKeyResult) {};
  rpc performAuthentication(PerformAuthPayload) returns (AuthResult) {};
}