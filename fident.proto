syntax = "proto3";

package fident;

message ServiceRegistrationResult {
  string identity_id = 1;
  string service_key = 2;
  string key_handle = 3;
}

message ServiceRegistrationPayload {
  string service_name = 1;
  string service_vendor = 2;
  string support_email = 3;
}

message AuthResult {
  string token = 1;
}

message AuthChallengeResult {
  string challenge = 1;
}

message AuthChallengePayload {
  string username = 1;
}

message PerformAuthPayload {
  string username = 1;
  string keyHandle = 2;
  string challenge_response = 3;
}

message AuthKeyRequestPayload {
  string username = 1;
  string password = 2;
  string usage_description = 3;
}

message AuthKeyResult {
  string username = 1;
  string identity_id = 2;
  string private_key = 3;
  string key_handle = 4;
}

service Auth {
  rpc CreateServiceAccount(ServiceRegistrationPayload) returns (ServiceRegistrationResult) {};
  rpc GetAuthenticationChallenge(AuthChallengePayload) returns (AuthChallengeResult) {};
  rpc GetNewAuthenticationKey(AuthKeyRequestPayload) returns (AuthKeyResult) {};
  rpc PerformAuthentication(PerformAuthPayload) returns (AuthResult) {};
}